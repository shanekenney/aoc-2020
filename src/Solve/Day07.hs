module Solve.Day07 where

import Data.Char
import Data.Graph (Graph)
import qualified Data.Graph as Graph
import Data.List
import Data.List.Split
import Data.Map (Map, (!))
import qualified Data.Map as Map
import Data.Maybe
import Data.String.Utils (replace, strip)

input :: String
input = "pale cyan bags contain 2 posh black bags, 4 wavy gold bags, 2 vibrant brown bags.\ndull lavender bags contain 3 pale tomato bags.\nlight red bags contain 3 wavy teal bags, 3 plaid aqua bags, 4 drab lavender bags, 2 bright coral bags.\nwavy green bags contain 3 wavy indigo bags.\nbright blue bags contain 5 vibrant tan bags.\ndotted fuchsia bags contain 5 dark orange bags, 1 shiny coral bag.\npale tomato bags contain 2 bright magenta bags, 5 dull lime bags.\nlight black bags contain 1 posh lavender bag, 5 dotted gold bags, 4 faded bronze bags.\nwavy turquoise bags contain 4 pale teal bags, 2 dim brown bags, 5 muted lime bags.\nstriped red bags contain 4 faded brown bags, 4 dotted purple bags.\nwavy silver bags contain 5 muted chartreuse bags, 1 light silver bag, 3 striped silver bags.\nposh lavender bags contain 5 striped silver bags, 3 wavy beige bags, 3 dim brown bags, 5 clear indigo bags.\npale maroon bags contain 1 striped white bag, 4 light blue bags.\ndrab turquoise bags contain 2 shiny tomato bags.\ndark aqua bags contain 2 plaid silver bags.\nvibrant coral bags contain 3 wavy lime bags, 2 shiny gold bags, 1 dotted orange bag, 3 muted indigo bags.\nclear green bags contain 1 clear olive bag.\nstriped indigo bags contain 3 striped turquoise bags.\nclear lime bags contain 3 mirrored green bags, 2 light tan bags.\ndrab bronze bags contain 5 plaid lavender bags, 1 muted yellow bag, 5 vibrant coral bags.\ndrab lavender bags contain 1 posh tomato bag, 4 muted salmon bags, 4 dull lime bags.\nstriped aqua bags contain 1 pale maroon bag.\nwavy gray bags contain 3 light tan bags, 2 pale white bags, 2 bright magenta bags, 5 muted salmon bags.\nfaded aqua bags contain 1 plaid salmon bag, 4 dotted yellow bags.\ndrab cyan bags contain 1 posh tomato bag, 4 shiny turquoise bags.\nvibrant blue bags contain no other bags.\nlight lime bags contain 3 vibrant purple bags.\nclear gray bags contain 3 mirrored olive bags, 3 clear crimson bags, 5 dark orange bags, 2 dim gold bags.\nbright magenta bags contain no other bags.\nwavy purple bags contain 4 dim gold bags, 5 light green bags.\nmuted bronze bags contain 2 pale beige bags, 2 clear turquoise bags, 5 posh white bags, 1 wavy gray bag.\nstriped violet bags contain 1 light gold bag.\ndull salmon bags contain 2 posh gray bags, 2 dotted blue bags.\nstriped orange bags contain 3 faded coral bags, 3 dotted lavender bags.\ndrab coral bags contain 1 wavy indigo bag, 1 dull black bag, 3 mirrored chartreuse bags.\nplaid yellow bags contain 5 faded cyan bags.\ndark maroon bags contain 2 mirrored silver bags, 5 muted salmon bags, 1 dull tomato bag.\ndark yellow bags contain 1 drab maroon bag, 5 faded cyan bags, 4 clear indigo bags.\nposh teal bags contain 3 vibrant maroon bags, 3 posh salmon bags.\nmirrored black bags contain 1 drab fuchsia bag, 2 posh red bags.\ndrab salmon bags contain 2 dull plum bags.\nmuted green bags contain 4 plaid gray bags, 2 dim turquoise bags, 2 dull coral bags, 4 dim white bags.\nbright indigo bags contain 1 bright turquoise bag, 4 dark beige bags.\nwavy fuchsia bags contain 1 clear violet bag, 4 striped bronze bags, 1 mirrored indigo bag, 1 shiny cyan bag.\nbright brown bags contain 5 dark purple bags.\ndull turquoise bags contain 3 dim yellow bags, 2 dim indigo bags.\npale coral bags contain 4 posh indigo bags.\nstriped green bags contain 4 dull green bags, 5 dotted turquoise bags, 3 pale red bags, 2 dark gold bags.\nfaded maroon bags contain 3 dim green bags, 4 wavy purple bags.\nvibrant lime bags contain 3 shiny fuchsia bags, 1 pale red bag, 1 vibrant bronze bag.\nshiny plum bags contain 2 bright maroon bags, 5 dull tomato bags, 2 plaid salmon bags, 3 bright lime bags.\nfaded silver bags contain 1 posh turquoise bag, 5 posh white bags, 5 wavy lime bags, 3 shiny coral bags.\nmirrored tomato bags contain 3 dotted tomato bags, 4 vibrant blue bags, 4 dull yellow bags, 5 clear chartreuse bags.\npale red bags contain 5 vibrant indigo bags, 4 vibrant red bags, 3 bright magenta bags, 3 dim indigo bags.\ndrab blue bags contain 2 bright magenta bags.\ndim purple bags contain 4 drab lavender bags, 4 plaid yellow bags, 5 dull white bags, 3 clear white bags.\ndim red bags contain 5 striped silver bags, 1 shiny red bag.\ndim lime bags contain 5 plaid bronze bags, 5 drab salmon bags.\nmirrored beige bags contain 3 bright tomato bags, 2 dull lime bags.\nbright lime bags contain 5 clear chartreuse bags.\nclear chartreuse bags contain 1 muted white bag, 1 vibrant bronze bag, 2 vibrant maroon bags, 4 clear lime bags.\ndotted indigo bags contain 4 pale olive bags, 1 bright violet bag, 3 drab gray bags.\nstriped crimson bags contain 3 muted salmon bags.\nplaid green bags contain 3 posh tomato bags.\ndim brown bags contain 3 striped teal bags, 3 vibrant aqua bags, 3 plaid yellow bags.\nfaded turquoise bags contain 2 dim blue bags, 3 clear green bags, 3 striped bronze bags, 2 dim beige bags.\ndotted coral bags contain 2 vibrant silver bags, 3 plaid crimson bags, 4 dull silver bags, 1 muted blue bag.\nmirrored magenta bags contain 3 striped teal bags, 1 mirrored black bag, 4 shiny black bags.\nshiny gray bags contain 3 bright magenta bags.\nmirrored violet bags contain 5 drab blue bags, 5 dark brown bags.\ndark beige bags contain 2 vibrant blue bags, 2 bright magenta bags, 1 dim indigo bag.\ndark bronze bags contain 3 vibrant chartreuse bags, 2 posh turquoise bags, 4 faded aqua bags.\nclear turquoise bags contain 1 mirrored green bag, 1 faded indigo bag, 4 shiny aqua bags, 4 dim tomato bags.\ndark silver bags contain 5 posh purple bags, 4 dull silver bags.\ndull tan bags contain 2 striped brown bags, 3 vibrant salmon bags, 1 drab gold bag.\nmirrored gray bags contain 2 dim white bags, 4 muted white bags, 1 muted orange bag, 3 muted magenta bags.\nfaded black bags contain 3 faded aqua bags, 4 drab white bags, 2 dull lavender bags, 1 bright purple bag.\nlight fuchsia bags contain 3 pale magenta bags.\nwavy lavender bags contain no other bags.\ndull black bags contain 1 mirrored teal bag.\nvibrant chartreuse bags contain 1 dull violet bag, 4 posh turquoise bags.\nposh yellow bags contain 5 wavy gold bags.\nshiny teal bags contain 2 drab salmon bags, 5 striped crimson bags.\nplaid fuchsia bags contain 3 dim brown bags, 2 posh bronze bags, 1 striped aqua bag, 1 shiny chartreuse bag.\nfaded yellow bags contain 1 dotted tan bag, 3 dark coral bags.\nmirrored orange bags contain 3 pale coral bags.\nwavy indigo bags contain 5 shiny coral bags, 2 shiny yellow bags, 2 striped brown bags.\ndotted salmon bags contain 1 drab turquoise bag, 1 vibrant lime bag, 3 dull chartreuse bags, 1 vibrant maroon bag.\ndull magenta bags contain 3 shiny coral bags, 5 dull violet bags, 5 mirrored violet bags.\nshiny tomato bags contain 1 dim salmon bag, 1 dim olive bag.\ndrab gold bags contain 3 drab maroon bags, 1 dotted black bag, 4 plaid orange bags.\nbright yellow bags contain 4 muted teal bags, 1 faded maroon bag, 5 posh chartreuse bags, 5 plaid indigo bags.\ndull plum bags contain 1 shiny salmon bag, 3 light tan bags.\nposh gray bags contain 3 muted lime bags, 2 dotted green bags.\nclear violet bags contain 5 vibrant maroon bags.\ndotted bronze bags contain 3 light tan bags, 4 shiny yellow bags, 3 mirrored brown bags, 1 plaid yellow bag.\nmirrored lime bags contain 2 bright teal bags, 2 dim gold bags, 2 dull tomato bags, 3 wavy green bags.\nshiny indigo bags contain 3 dull silver bags, 2 dim cyan bags, 2 striped magenta bags.\nvibrant crimson bags contain 2 light chartreuse bags.\ndim magenta bags contain 5 plaid olive bags, 2 muted green bags, 4 bright crimson bags.\ndim blue bags contain 1 bright silver bag, 2 shiny gray bags.\nplaid teal bags contain 4 shiny aqua bags, 1 dull fuchsia bag, 4 bright lime bags.\ndull teal bags contain 2 dotted black bags.\nplaid gray bags contain 5 muted brown bags.\npale teal bags contain 5 striped olive bags, 1 dotted fuchsia bag, 3 dark teal bags, 2 dim purple bags.\nclear beige bags contain 3 pale lime bags, 4 striped aqua bags, 3 mirrored red bags.\nmirrored green bags contain 4 mirrored olive bags, 5 dim salmon bags, 4 vibrant bronze bags.\nplaid aqua bags contain 2 pale white bags, 1 dull plum bag, 4 mirrored olive bags, 3 dim maroon bags.\npale aqua bags contain 5 bright salmon bags, 4 vibrant silver bags, 2 light orange bags.\nplaid crimson bags contain 3 striped magenta bags.\nmirrored red bags contain 5 dull coral bags, 5 pale yellow bags, 5 drab maroon bags, 2 dim gray bags.\npale black bags contain 1 light red bag, 4 faded teal bags.\ndim turquoise bags contain 5 faded purple bags, 4 wavy fuchsia bags, 3 vibrant purple bags, 2 pale beige bags.\ndim lavender bags contain 1 light blue bag.\npale gray bags contain 3 mirrored red bags, 5 light indigo bags.\nclear magenta bags contain 5 bright gold bags, 5 dim lavender bags, 1 wavy lavender bag.\ndull gold bags contain 4 dull fuchsia bags, 3 vibrant tan bags.\ndim salmon bags contain 5 dull yellow bags, 4 pale beige bags.\ndrab magenta bags contain 2 vibrant salmon bags.\nvibrant green bags contain 3 bright purple bags, 5 wavy brown bags, 5 dotted gray bags, 1 posh bronze bag.\ndull brown bags contain 1 wavy tan bag, 1 shiny salmon bag.\nclear white bags contain 5 bright lime bags, 3 light tan bags.\ndotted lavender bags contain 5 wavy cyan bags, 2 dark indigo bags, 4 shiny gold bags.\ndotted purple bags contain 5 dull teal bags, 3 shiny plum bags.\ndrab yellow bags contain 3 faded beige bags, 3 light silver bags.\ndark orange bags contain 5 bright lime bags.\ndotted cyan bags contain 1 vibrant lime bag, 1 wavy maroon bag, 2 dull tan bags, 5 shiny salmon bags.\nposh indigo bags contain 5 dull yellow bags, 1 vibrant bronze bag.\ndull chartreuse bags contain 2 wavy lavender bags, 5 vibrant blue bags.\nposh blue bags contain 3 wavy maroon bags.\ndim teal bags contain 3 muted turquoise bags, 1 vibrant black bag, 5 dotted tomato bags.\npale purple bags contain 1 striped olive bag.\ndrab chartreuse bags contain 1 clear orange bag, 2 plaid turquoise bags, 2 drab maroon bags.\nplaid white bags contain 4 plaid indigo bags, 5 vibrant lime bags.\nvibrant bronze bags contain 5 vibrant blue bags, 1 drab blue bag, 1 dull lime bag.\nbright bronze bags contain 3 muted magenta bags, 3 dotted black bags, 1 pale lime bag, 2 dull violet bags.\ndark indigo bags contain 3 bright maroon bags.\nmuted lavender bags contain 1 light white bag, 2 clear white bags, 2 posh white bags, 3 dim purple bags.\nvibrant violet bags contain 5 dull magenta bags, 4 posh coral bags.\ndrab beige bags contain 2 plaid magenta bags, 2 muted bronze bags, 2 muted purple bags.\ndrab plum bags contain 4 mirrored tomato bags, 3 light lavender bags, 3 mirrored green bags, 5 muted salmon bags.\nmirrored fuchsia bags contain 1 mirrored tomato bag, 5 dotted black bags, 2 posh white bags.\npale crimson bags contain 4 light plum bags.\ndotted black bags contain 3 bright maroon bags.\nwavy tomato bags contain 1 dim black bag, 5 vibrant coral bags, 1 mirrored purple bag.\nbright aqua bags contain 5 pale lime bags, 3 striped teal bags.\nvibrant purple bags contain 2 clear turquoise bags, 4 vibrant bronze bags, 1 dark lime bag, 3 clear crimson bags.\nvibrant tan bags contain 4 posh black bags.\nplaid turquoise bags contain 2 dotted violet bags, 5 mirrored plum bags.\ndim violet bags contain 3 dotted orange bags.\nbright tan bags contain 2 dark indigo bags, 4 faded purple bags, 4 dim blue bags.\nmuted chartreuse bags contain 4 dotted black bags, 5 mirrored tomato bags.\nmuted gold bags contain 2 wavy gray bags, 4 clear gold bags, 1 shiny gold bag.\ndull indigo bags contain 3 mirrored maroon bags.\nclear aqua bags contain 4 dim plum bags, 5 bright bronze bags.\nmuted maroon bags contain 1 striped crimson bag, 3 vibrant aqua bags.\nmuted blue bags contain 4 clear magenta bags, 4 pale bronze bags, 2 dull black bags, 4 striped olive bags.\ndrab aqua bags contain 3 faded crimson bags.\nshiny olive bags contain 4 shiny salmon bags, 2 wavy plum bags, 4 pale bronze bags, 3 posh gold bags.\nstriped bronze bags contain 4 plaid olive bags, 4 plaid indigo bags, 1 pale white bag, 3 striped magenta bags.\nmirrored gold bags contain 2 faded lavender bags.\nfaded blue bags contain 1 plaid bronze bag, 3 dim olive bags, 2 wavy crimson bags, 4 plaid silver bags.\nplaid lime bags contain 2 dim yellow bags.\nmirrored brown bags contain 4 light crimson bags.\nplaid red bags contain 5 shiny aqua bags, 5 wavy lavender bags, 1 posh beige bag.\nmirrored coral bags contain 4 mirrored lime bags, 5 muted orange bags, 5 dotted salmon bags, 1 faded purple bag.\nmirrored olive bags contain 2 vibrant blue bags.\npale orange bags contain 4 wavy lime bags.\ndrab maroon bags contain 1 shiny yellow bag, 3 dull yellow bags, 1 wavy lavender bag, 2 dim salmon bags.\ndrab purple bags contain 5 bright tomato bags, 4 striped bronze bags, 2 bright chartreuse bags, 2 dark violet bags.\nstriped lime bags contain 5 posh turquoise bags, 1 dim purple bag.\nwavy beige bags contain 5 shiny tomato bags, 3 drab lavender bags, 1 shiny orange bag.\nbright gold bags contain 5 vibrant red bags, 1 shiny orange bag, 3 striped bronze bags.\nmuted magenta bags contain 4 light olive bags, 3 dotted tan bags.\ndark lime bags contain 5 wavy lavender bags, 4 clear maroon bags, 2 striped beige bags, 4 plaid salmon bags.\npale silver bags contain 3 faded lavender bags, 2 dotted purple bags, 3 wavy crimson bags.\nposh turquoise bags contain 5 dim yellow bags, 4 posh lime bags, 5 shiny orange bags.\nshiny coral bags contain 2 dull tomato bags.\ndim tomato bags contain 3 shiny aqua bags, 3 light cyan bags.\nplaid tomato bags contain 3 faded indigo bags.\nclear tan bags contain 3 mirrored indigo bags.\nwavy maroon bags contain 1 dark silver bag.\ndrab teal bags contain 5 muted salmon bags, 4 plaid yellow bags, 4 bright red bags, 2 posh teal bags.\ndim plum bags contain 5 posh salmon bags, 5 faded purple bags, 2 posh brown bags.\nbright fuchsia bags contain 2 dark beige bags, 3 faded yellow bags.\nclear silver bags contain 2 plaid tomato bags, 4 muted chartreuse bags.\nshiny purple bags contain 5 muted lavender bags, 2 clear turquoise bags, 4 muted teal bags.\ndark red bags contain 3 plaid plum bags, 2 dim indigo bags, 2 wavy gray bags.\ndark white bags contain 4 muted bronze bags, 5 mirrored gold bags, 3 plaid lavender bags.\ndrab silver bags contain 1 dark gold bag, 3 muted white bags.\ndark green bags contain 3 posh turquoise bags.\nstriped white bags contain 1 vibrant maroon bag, 1 shiny salmon bag.\nstriped lavender bags contain 1 light tomato bag, 5 light lime bags, 1 posh gold bag.\nmirrored tan bags contain 2 posh fuchsia bags.\npale salmon bags contain 4 shiny blue bags.\ndark black bags contain 1 dotted coral bag, 1 faded crimson bag, 4 drab violet bags, 5 clear chartreuse bags.\nvibrant red bags contain 1 dim gold bag, 2 dull yellow bags, 1 faded brown bag, 4 light cyan bags.\npale turquoise bags contain 5 clear cyan bags.\nbright olive bags contain 1 clear turquoise bag, 4 bright teal bags, 3 striped maroon bags, 1 striped gold bag.\nshiny green bags contain 5 dim lime bags, 3 wavy brown bags, 2 faded magenta bags, 5 drab maroon bags.\nvibrant tomato bags contain 3 striped plum bags, 2 vibrant maroon bags, 4 muted silver bags, 3 striped chartreuse bags.\nvibrant yellow bags contain 3 pale beige bags, 4 dim orange bags, 4 dotted cyan bags.\nmuted aqua bags contain 3 vibrant purple bags.\ndull orange bags contain 2 striped gray bags, 3 vibrant bronze bags, 2 bright turquoise bags.\nwavy cyan bags contain 2 drab maroon bags, 4 shiny aqua bags, 5 clear lime bags.\nfaded tan bags contain 3 muted turquoise bags, 2 plaid purple bags, 3 clear crimson bags.\nlight maroon bags contain 5 wavy chartreuse bags, 3 mirrored silver bags, 5 muted plum bags, 2 mirrored blue bags.\nshiny lavender bags contain 1 dark silver bag, 5 clear teal bags, 5 dark red bags, 4 faded red bags.\nstriped fuchsia bags contain 4 clear gold bags, 3 bright magenta bags, 3 bright aqua bags.\nstriped plum bags contain 4 bright lime bags, 5 dotted black bags, 5 drab beige bags.\ndotted red bags contain 4 dim gold bags, 3 dim indigo bags, 4 striped olive bags, 5 dim white bags.\nmirrored chartreuse bags contain 5 posh tomato bags.\ndim white bags contain 5 clear maroon bags.\nmuted black bags contain 2 posh turquoise bags, 3 clear lavender bags, 2 shiny aqua bags, 2 pale red bags.\nmuted silver bags contain 4 striped white bags, 5 dotted tomato bags, 4 mirrored fuchsia bags, 2 clear maroon bags.\ndotted lime bags contain 1 muted aqua bag, 3 mirrored tan bags.\nfaded chartreuse bags contain 4 vibrant violet bags, 5 faded magenta bags, 5 dim teal bags, 2 dim green bags.\nlight turquoise bags contain 1 dotted purple bag.\nplaid cyan bags contain 1 bright magenta bag, 2 wavy chartreuse bags, 5 vibrant silver bags, 3 pale crimson bags.\ndull maroon bags contain 5 dim black bags.\nwavy violet bags contain 1 faded yellow bag.\nvibrant teal bags contain 5 dim lime bags, 2 vibrant gold bags, 2 dim beige bags.\npale fuchsia bags contain 3 striped olive bags.\nlight brown bags contain 3 shiny chartreuse bags, 2 wavy purple bags.\ndull green bags contain 3 striped orange bags, 2 posh indigo bags, 3 faded blue bags.\ndark blue bags contain 5 striped magenta bags, 3 striped gray bags, 4 pale coral bags.\nmirrored lavender bags contain 3 posh black bags.\nshiny brown bags contain 5 dotted magenta bags, 4 dim chartreuse bags, 1 posh cyan bag.\nmuted brown bags contain 3 dull black bags, 3 pale maroon bags, 5 posh brown bags, 2 striped gray bags.\nfaded orange bags contain 1 dark orange bag.\nmuted fuchsia bags contain 3 plaid salmon bags.\nclear plum bags contain 3 shiny red bags, 4 dim silver bags.\nbright coral bags contain 4 pale yellow bags, 2 muted magenta bags, 2 bright chartreuse bags, 3 light olive bags.\nmuted coral bags contain 4 striped green bags.\ndrab olive bags contain 3 shiny salmon bags, 4 clear cyan bags.\ndim silver bags contain 2 shiny plum bags.\nwavy plum bags contain 3 mirrored fuchsia bags, 5 pale maroon bags, 5 posh salmon bags.\nplaid coral bags contain 1 mirrored gold bag.\nposh beige bags contain 3 mirrored maroon bags, 3 drab chartreuse bags, 3 dark salmon bags, 1 clear green bag.\ndrab green bags contain 1 bright teal bag, 3 muted chartreuse bags.\nbright crimson bags contain 3 striped orange bags, 4 wavy plum bags.\nposh chartreuse bags contain 5 clear white bags, 3 light red bags.\ndim gray bags contain 1 mirrored fuchsia bag, 3 muted teal bags, 4 clear maroon bags, 5 striped white bags.\nstriped brown bags contain 2 muted orange bags.\ndim tan bags contain 3 clear gold bags, 5 clear salmon bags, 2 dark chartreuse bags.\nstriped magenta bags contain 2 plaid indigo bags, 5 drab lavender bags, 2 dotted fuchsia bags, 4 shiny aqua bags.\ndotted violet bags contain 3 dull tomato bags.\ndotted tan bags contain 1 dark orange bag, 2 drab blue bags.\nshiny beige bags contain 1 drab gold bag.\nlight plum bags contain 5 plaid tomato bags, 5 wavy gray bags, 1 dull tomato bag.\nmuted indigo bags contain 3 dim salmon bags.\nclear red bags contain 3 mirrored beige bags.\nmirrored silver bags contain 2 wavy plum bags, 4 vibrant magenta bags.\ndark lavender bags contain 2 wavy violet bags, 5 muted green bags, 2 dim purple bags.\nclear teal bags contain 4 wavy crimson bags.\nlight purple bags contain 5 faded black bags.\nlight salmon bags contain 3 vibrant beige bags, 3 striped white bags, 5 pale magenta bags, 5 muted blue bags.\ndull gray bags contain 5 dim lavender bags.\nposh aqua bags contain 1 light olive bag, 4 mirrored purple bags, 4 vibrant gold bags, 1 shiny aqua bag.\npale chartreuse bags contain 5 faded indigo bags.\nstriped cyan bags contain 1 shiny olive bag, 3 bright tomato bags, 1 faded beige bag.\nclear coral bags contain 5 clear violet bags, 1 plaid tomato bag.\nbright cyan bags contain 3 mirrored violet bags, 5 plaid magenta bags, 4 vibrant bronze bags.\nposh tomato bags contain 3 shiny aqua bags, 1 pale beige bag.\nbright lavender bags contain 4 clear beige bags, 2 faded lavender bags, 3 faded aqua bags, 5 pale purple bags.\ndotted teal bags contain 5 plaid salmon bags, 1 posh turquoise bag, 2 muted silver bags.\nclear tomato bags contain 5 bright indigo bags.\ndotted silver bags contain 2 mirrored indigo bags.\nplaid plum bags contain 4 light crimson bags.\nwavy magenta bags contain 2 posh indigo bags, 2 vibrant indigo bags.\ndull tomato bags contain 4 dull lime bags, 4 faded brown bags.\nvibrant black bags contain 5 light crimson bags, 5 pale lavender bags, 3 dull blue bags, 2 pale coral bags.\npale bronze bags contain 3 vibrant violet bags.\nwavy lime bags contain 5 shiny yellow bags, 2 pale white bags, 1 clear gold bag, 5 mirrored chartreuse bags.\nstriped gray bags contain 3 shiny tomato bags, 3 dull coral bags, 1 shiny aqua bag, 2 dark orange bags.\nfaded crimson bags contain 4 pale white bags, 3 muted bronze bags, 2 posh blue bags, 3 bright coral bags.\nwavy orange bags contain 2 shiny indigo bags.\ndotted white bags contain 1 striped tan bag, 4 bright silver bags, 1 shiny fuchsia bag, 3 posh gray bags.\nposh bronze bags contain 4 muted silver bags, 1 light lavender bag.\ndotted magenta bags contain 5 clear fuchsia bags, 4 faded indigo bags, 3 dull turquoise bags, 4 muted orange bags.\ndull cyan bags contain 3 clear teal bags, 3 dim white bags, 3 dull tomato bags, 5 vibrant purple bags.\nclear gold bags contain 4 dim gold bags, 3 dull lime bags, 4 faded brown bags, 4 wavy gray bags.\nbright beige bags contain 3 dull cyan bags, 4 bright indigo bags, 2 dull lime bags.\nclear orange bags contain 5 shiny salmon bags.\nplaid silver bags contain 5 dotted purple bags, 1 dim maroon bag, 3 muted gold bags.\nshiny white bags contain 1 light brown bag, 1 mirrored lime bag.\ndark gray bags contain 5 shiny cyan bags, 2 drab tomato bags.\ndrab white bags contain 4 shiny tomato bags, 3 shiny gold bags, 3 dull lime bags, 3 plaid orange bags.\nvibrant cyan bags contain 2 wavy purple bags, 4 light gold bags, 1 pale indigo bag, 2 striped fuchsia bags.\nshiny yellow bags contain 4 shiny aqua bags, 2 dim salmon bags, 3 posh tomato bags, 5 muted salmon bags.\nposh coral bags contain 2 striped gray bags, 4 dark orange bags, 5 posh magenta bags.\nclear salmon bags contain 4 posh yellow bags, 2 pale violet bags, 3 mirrored violet bags.\nposh olive bags contain 2 mirrored red bags, 3 faded gold bags.\nfaded fuchsia bags contain 5 bright gold bags, 3 pale tomato bags, 2 dotted bronze bags, 1 mirrored green bag.\nstriped maroon bags contain 4 posh maroon bags, 4 dim indigo bags, 5 shiny aqua bags, 4 posh lime bags.\ndark violet bags contain 5 plaid tomato bags, 3 bright lime bags, 4 light lavender bags, 4 dark brown bags.\ndim maroon bags contain 1 dark beige bag, 4 wavy gray bags, 5 shiny coral bags, 1 pale white bag.\nwavy crimson bags contain 1 light tan bag, 5 dark beige bags.\nplaid magenta bags contain 1 shiny turquoise bag, 1 dark lime bag, 5 dim salmon bags.\nclear indigo bags contain 4 muted maroon bags.\nclear olive bags contain 5 mirrored teal bags, 1 plaid lime bag, 3 dull magenta bags, 5 wavy gray bags.\nmirrored white bags contain 3 pale gold bags.\nwavy blue bags contain 1 dotted aqua bag, 5 dark green bags.\nfaded cyan bags contain 4 wavy gray bags, 5 vibrant bronze bags, 1 mirrored olive bag, 3 drab blue bags.\nfaded gray bags contain 2 drab brown bags, 4 dotted coral bags, 5 dim turquoise bags, 1 mirrored maroon bag.\ndim coral bags contain 5 shiny olive bags, 3 light plum bags.\nvibrant fuchsia bags contain 5 shiny chartreuse bags, 5 wavy bronze bags, 2 bright red bags.\ndotted tomato bags contain 5 faded indigo bags, 3 vibrant maroon bags, 4 shiny coral bags.\nfaded salmon bags contain 3 dull silver bags, 2 wavy bronze bags, 2 drab teal bags.\nvibrant orange bags contain 1 dotted beige bag.\nmuted violet bags contain 5 posh lime bags.\nstriped tan bags contain 3 muted lime bags.\ndrab violet bags contain 3 vibrant chartreuse bags, 5 posh turquoise bags, 1 bright cyan bag.\nbright purple bags contain 2 vibrant bronze bags, 3 wavy beige bags, 2 plaid bronze bags.\nvibrant maroon bags contain no other bags.\nmuted teal bags contain 2 bright turquoise bags.\nbright plum bags contain 5 dark gold bags, 2 shiny turquoise bags, 1 dull yellow bag.\nshiny crimson bags contain 3 wavy magenta bags.\nwavy teal bags contain 5 faded indigo bags, 4 dotted gray bags, 3 pale chartreuse bags, 3 vibrant coral bags.\nshiny blue bags contain 2 shiny salmon bags, 4 light tan bags, 1 dim salmon bag.\nmirrored maroon bags contain 1 drab fuchsia bag, 3 dotted green bags, 3 muted white bags.\nclear maroon bags contain 2 vibrant red bags, 5 bright maroon bags, 4 light olive bags.\nbright salmon bags contain 1 dotted red bag, 4 vibrant beige bags, 3 dark maroon bags, 3 clear lavender bags.\npale gold bags contain 3 plaid olive bags.\nfaded lime bags contain 3 faded maroon bags, 5 mirrored aqua bags.\nfaded magenta bags contain 4 plaid orange bags, 5 vibrant violet bags, 1 dotted green bag, 3 wavy crimson bags.\nwavy aqua bags contain 5 drab yellow bags, 5 posh bronze bags.\nfaded brown bags contain 3 mirrored green bags, 5 dim salmon bags, 4 vibrant blue bags, 1 wavy gray bag.\ndark purple bags contain 4 pale beige bags, 3 drab lavender bags.\ndull lime bags contain no other bags.\nlight orange bags contain 1 vibrant white bag, 1 striped magenta bag.\nmirrored plum bags contain 1 clear green bag, 4 faded blue bags.\nvibrant brown bags contain 4 dark crimson bags, 5 light plum bags.\nshiny turquoise bags contain 1 dark lime bag.\ndark plum bags contain 2 wavy coral bags, 2 striped gray bags, 4 muted blue bags, 2 dull aqua bags.\nshiny red bags contain 1 plaid gray bag, 4 wavy beige bags, 5 dark red bags.\nposh violet bags contain 5 striped chartreuse bags, 2 pale maroon bags, 1 dull lime bag.\nlight silver bags contain 2 clear silver bags, 1 dark indigo bag, 2 dim salmon bags, 2 drab salmon bags.\nplaid orange bags contain 4 dim gold bags, 2 bright magenta bags, 4 drab lavender bags.\nvibrant silver bags contain 5 posh plum bags, 3 vibrant aqua bags, 2 light lavender bags.\nfaded tomato bags contain 1 pale coral bag, 2 posh gold bags.\nshiny silver bags contain 4 faded orange bags, 1 striped white bag, 2 faded turquoise bags, 5 striped gray bags.\nplaid purple bags contain 2 posh olive bags, 3 pale maroon bags, 3 pale gold bags, 1 faded white bag.\nlight tomato bags contain 2 vibrant indigo bags, 4 dark orange bags, 5 muted bronze bags, 4 plaid tomato bags.\ndull aqua bags contain 5 bright lime bags.\ndrab red bags contain 5 posh teal bags.\ndotted gray bags contain 2 vibrant salmon bags, 4 mirrored chartreuse bags, 1 dotted tomato bag, 4 posh magenta bags.\ndull bronze bags contain 3 mirrored brown bags.\nshiny aqua bags contain no other bags.\ndim gold bags contain no other bags.\npale blue bags contain 4 posh gray bags.\nfaded purple bags contain 5 shiny blue bags, 5 plaid salmon bags, 4 pale tomato bags, 2 dark gold bags.\nstriped teal bags contain 4 mirrored green bags.\nshiny orange bags contain 4 faded lavender bags, 2 muted salmon bags, 2 dim indigo bags.\nwavy yellow bags contain 5 clear silver bags, 2 shiny brown bags.\nvibrant turquoise bags contain 1 vibrant magenta bag, 4 dull fuchsia bags, 5 mirrored green bags.\ndark teal bags contain 5 dim tomato bags.\nposh brown bags contain 3 dark orange bags.\nvibrant gray bags contain 2 dark beige bags, 2 wavy teal bags, 3 light purple bags.\ndrab black bags contain 1 mirrored maroon bag, 3 pale silver bags, 3 dark brown bags, 1 shiny gray bag.\nlight blue bags contain 2 dim olive bags, 2 striped magenta bags.\nmuted turquoise bags contain 3 dim lime bags, 3 shiny coral bags.\nfaded red bags contain 5 clear gray bags.\nbright chartreuse bags contain 4 plaid teal bags, 5 drab salmon bags, 5 wavy cyan bags.\nlight magenta bags contain 5 light aqua bags, 4 light crimson bags, 3 dark yellow bags, 1 light tomato bag.\nstriped coral bags contain 3 mirrored white bags.\nshiny maroon bags contain 1 vibrant red bag, 3 bright red bags.\nstriped yellow bags contain 1 bright orange bag, 2 faded plum bags, 3 light olive bags, 3 shiny aqua bags.\ndull olive bags contain 2 posh fuchsia bags, 2 dull coral bags, 2 faded red bags.\ndotted yellow bags contain 1 drab salmon bag, 3 pale fuchsia bags.\nlight bronze bags contain 3 drab cyan bags, 5 mirrored orange bags, 4 plaid crimson bags.\nshiny chartreuse bags contain 1 wavy cyan bag, 4 shiny tomato bags.\ndull yellow bags contain no other bags.\nfaded plum bags contain 5 vibrant blue bags, 5 clear indigo bags, 5 posh teal bags, 4 posh plum bags.\nwavy salmon bags contain 4 striped teal bags, 3 wavy tan bags, 1 clear white bag.\nposh salmon bags contain 4 dull chartreuse bags, 4 shiny yellow bags, 2 dotted black bags, 3 clear lime bags.\ndull white bags contain 2 dim olive bags, 4 vibrant bronze bags, 4 faded cyan bags.\nshiny gold bags contain 5 bright maroon bags, 5 shiny aqua bags, 2 clear lime bags, 2 muted white bags.\nposh plum bags contain 4 posh purple bags, 2 wavy beige bags, 5 plaid plum bags.\nshiny magenta bags contain 4 shiny tan bags, 2 dull green bags, 3 mirrored purple bags.\nwavy olive bags contain 4 vibrant olive bags, 2 clear fuchsia bags, 1 light plum bag, 2 dark violet bags.\nmuted lime bags contain 4 posh white bags, 4 shiny tomato bags.\nlight indigo bags contain 2 clear turquoise bags, 3 vibrant black bags, 3 striped lime bags.\nmuted yellow bags contain 3 mirrored tomato bags.\nfaded beige bags contain 5 clear red bags, 3 dull brown bags, 4 dark red bags, 1 vibrant magenta bag.\nstriped turquoise bags contain 2 bright aqua bags, 5 dim cyan bags, 1 pale lavender bag.\npale beige bags contain no other bags.\ndull silver bags contain 3 bright lime bags, 2 pale tomato bags, 3 mirrored green bags.\nclear cyan bags contain 1 vibrant blue bag, 2 faded cyan bags, 1 faded brown bag.\nposh green bags contain 2 vibrant gray bags, 1 pale magenta bag.\nmuted beige bags contain 2 drab blue bags, 3 vibrant magenta bags, 5 pale tomato bags.\nbright silver bags contain 4 dull brown bags, 4 vibrant violet bags, 4 dim violet bags.\nmirrored bronze bags contain 2 bright indigo bags, 3 shiny coral bags.\ndull red bags contain 4 dull plum bags, 1 striped black bag, 1 dim teal bag, 4 dim white bags.\ndim chartreuse bags contain 3 drab maroon bags.\ndrab crimson bags contain 5 dull turquoise bags, 3 posh gold bags, 4 bright gold bags, 2 muted indigo bags.\nwavy brown bags contain 1 muted white bag.\nplaid violet bags contain 2 faded tomato bags.\nmuted salmon bags contain 1 light cyan bag, 1 vibrant blue bag.\nmirrored salmon bags contain 1 dotted green bag, 2 plaid salmon bags.\nposh lime bags contain 1 vibrant blue bag.\nshiny tan bags contain 2 bright red bags, 1 dim maroon bag, 3 vibrant salmon bags.\nvibrant aqua bags contain 5 shiny orange bags, 2 dull coral bags, 4 vibrant bronze bags, 5 dark indigo bags.\nposh magenta bags contain 5 dim maroon bags, 2 wavy indigo bags.\nposh red bags contain 4 dull black bags, 2 shiny tomato bags, 4 faded beige bags.\nmirrored indigo bags contain 4 faded magenta bags, 1 light red bag, 3 muted gray bags, 2 plaid lavender bags.\ndrab indigo bags contain 4 dull tan bags, 2 dark coral bags.\nvibrant lavender bags contain 5 posh turquoise bags, 4 posh bronze bags, 5 light tomato bags.\nmirrored blue bags contain 1 striped bronze bag, 4 plaid salmon bags, 3 posh lime bags, 4 mirrored green bags.\nplaid blue bags contain 4 bright violet bags, 5 clear red bags.\ndark tan bags contain 3 faded chartreuse bags, 1 posh gold bag, 5 light chartreuse bags.\nbright teal bags contain 3 pale yellow bags, 1 vibrant white bag, 3 shiny salmon bags, 1 plaid indigo bag.\ndark gold bags contain 1 mirrored green bag.\nplaid beige bags contain 5 dim cyan bags.\npale plum bags contain 4 striped olive bags, 1 mirrored violet bag.\ndrab orange bags contain 1 plaid cyan bag, 2 vibrant green bags, 4 striped crimson bags, 2 posh teal bags.\nfaded teal bags contain 4 muted salmon bags, 1 dim tomato bag, 5 clear white bags.\nposh cyan bags contain 3 shiny gray bags, 2 posh indigo bags.\nplaid tan bags contain 4 plaid silver bags, 2 dark beige bags, 3 plaid salmon bags, 5 light beige bags.\nmuted olive bags contain 5 vibrant salmon bags, 2 dull orange bags.\nmuted tan bags contain 5 wavy gold bags, 2 striped orange bags, 4 plaid lavender bags.\nposh tan bags contain 3 shiny lavender bags, 5 vibrant red bags, 4 light bronze bags.\nbright tomato bags contain 3 dull lime bags, 3 wavy gray bags.\ndark turquoise bags contain 3 vibrant coral bags, 4 wavy beige bags.\nfaded indigo bags contain 4 wavy gray bags.\nclear blue bags contain 2 pale yellow bags.\nlight gold bags contain 5 light olive bags, 4 clear white bags, 3 plaid silver bags, 2 bright maroon bags.\nlight lavender bags contain 2 dotted black bags, 4 plaid tomato bags, 4 dark orange bags, 5 shiny blue bags.\nfaded coral bags contain 5 pale gold bags, 4 dull black bags.\nvibrant salmon bags contain 2 faded teal bags, 4 drab lavender bags, 5 clear teal bags, 1 dim olive bag.\nmuted orange bags contain 1 posh salmon bag, 2 light cyan bags, 5 shiny tomato bags, 4 dim olive bags.\nclear black bags contain 3 wavy bronze bags, 4 wavy lime bags, 4 shiny black bags.\npale violet bags contain 1 faded violet bag, 3 pale chartreuse bags, 5 drab blue bags.\ndotted plum bags contain 2 muted chartreuse bags, 3 vibrant turquoise bags, 5 posh brown bags.\nplaid maroon bags contain 1 posh coral bag, 1 dull fuchsia bag.\ndotted brown bags contain 1 posh lime bag, 5 dull turquoise bags.\npale green bags contain 3 drab magenta bags, 4 dim salmon bags, 1 vibrant chartreuse bag.\ndark tomato bags contain 2 clear indigo bags, 1 light plum bag, 2 dull turquoise bags.\nstriped silver bags contain 5 dark red bags, 4 faded purple bags.\nshiny fuchsia bags contain 2 dark gold bags, 3 dull tomato bags.\nmirrored aqua bags contain 5 dark bronze bags.\ndim beige bags contain 5 dull white bags.\ndark chartreuse bags contain 4 light crimson bags, 3 dim salmon bags, 2 dark orange bags.\nplaid chartreuse bags contain 4 drab blue bags.\ndim green bags contain 4 muted bronze bags, 1 shiny indigo bag.\nmirrored crimson bags contain 5 wavy fuchsia bags, 2 vibrant magenta bags.\nclear yellow bags contain 3 plaid bronze bags, 1 light tan bag.\nbright turquoise bags contain 3 shiny salmon bags.\ndrab brown bags contain 1 vibrant fuchsia bag.\ndim bronze bags contain 2 dim aqua bags, 4 dim beige bags.\ndim black bags contain 1 posh purple bag, 4 mirrored bronze bags, 5 posh plum bags.\nplaid gold bags contain 4 posh silver bags, 5 light turquoise bags, 3 vibrant black bags.\ndrab lime bags contain 1 muted gold bag, 4 dotted red bags.\nbright red bags contain 1 dull yellow bag, 4 mirrored gold bags.\nvibrant white bags contain 2 dull lime bags, 2 faded indigo bags, 1 faded brown bag, 1 muted salmon bag.\ndrab fuchsia bags contain 3 pale beige bags, 3 dark orange bags.\nstriped tomato bags contain 1 dark lime bag, 5 dull coral bags.\nfaded green bags contain 2 wavy blue bags.\nvibrant olive bags contain 3 bright tomato bags, 4 wavy beige bags.\ndark coral bags contain 5 faded teal bags, 1 mirrored tomato bag, 3 dark orange bags, 5 plaid lime bags.\nbright violet bags contain 4 dark lime bags.\nwavy tan bags contain 4 light tan bags, 3 vibrant red bags, 2 mirrored olive bags.\ndotted beige bags contain 5 striped gray bags, 4 posh plum bags, 1 bright turquoise bag, 4 striped fuchsia bags.\ndotted turquoise bags contain 3 mirrored green bags, 4 posh gold bags, 5 drab plum bags.\nstriped beige bags contain 1 clear gold bag, 1 vibrant white bag, 3 faded cyan bags, 2 shiny gold bags.\nposh silver bags contain 2 vibrant gold bags, 2 mirrored violet bags.\nmirrored purple bags contain 2 dim yellow bags, 2 dull tomato bags.\nshiny lime bags contain 4 clear olive bags, 4 mirrored silver bags, 1 muted tomato bag.\nmuted cyan bags contain 1 posh coral bag, 5 drab blue bags, 4 wavy lavender bags.\nlight aqua bags contain 1 dark orange bag.\nshiny cyan bags contain 2 dark maroon bags, 5 shiny salmon bags, 5 muted salmon bags, 2 wavy bronze bags.\nposh white bags contain 1 posh fuchsia bag.\nvibrant plum bags contain 4 light crimson bags.\ndotted blue bags contain 1 shiny tan bag, 3 light plum bags, 5 dotted gray bags.\nposh maroon bags contain 5 mirrored violet bags.\ndull violet bags contain 1 faded teal bag, 2 wavy cyan bags, 3 dull silver bags, 3 vibrant red bags.\nposh gold bags contain 4 muted salmon bags, 4 dull plum bags, 3 muted bronze bags.\ndim orange bags contain 2 dull coral bags.\ndim aqua bags contain 1 drab maroon bag.\nstriped salmon bags contain 4 muted white bags.\ndark cyan bags contain 3 plaid maroon bags.\nwavy red bags contain 2 wavy maroon bags, 2 vibrant chartreuse bags, 5 wavy salmon bags.\nlight yellow bags contain 4 posh lime bags, 1 light white bag.\nstriped blue bags contain 5 plaid magenta bags, 5 vibrant gold bags.\ndark olive bags contain 4 dim maroon bags, 2 shiny tan bags, 5 wavy green bags.\nvibrant gold bags contain 1 dull beige bag, 4 posh turquoise bags.\nmuted white bags contain 1 dim indigo bag, 5 dull lime bags, 5 shiny aqua bags.\nlight violet bags contain 5 wavy bronze bags.\npale olive bags contain 1 dim gold bag, 2 shiny coral bags.\nlight gray bags contain 3 bright gold bags.\ndim indigo bags contain 3 posh tomato bags, 5 pale tomato bags, 4 shiny aqua bags.\npale indigo bags contain 4 pale bronze bags, 5 light chartreuse bags.\nmuted red bags contain 3 clear white bags, 4 dull lavender bags, 5 muted purple bags.\nplaid olive bags contain 3 dark orange bags, 3 dim gold bags.\ndotted maroon bags contain 3 faded purple bags, 5 light green bags.\nbright orange bags contain 1 shiny black bag, 2 dim lavender bags, 1 shiny olive bag.\nwavy chartreuse bags contain 3 clear lime bags, 4 pale maroon bags.\nmirrored turquoise bags contain 2 striped crimson bags, 4 vibrant bronze bags, 5 dotted lavender bags, 2 clear silver bags.\ndull purple bags contain 4 posh crimson bags.\nfaded bronze bags contain 1 clear fuchsia bag, 2 light fuchsia bags, 2 pale chartreuse bags.\nclear bronze bags contain 3 pale chartreuse bags, 5 dull tan bags, 1 vibrant tan bag.\nvibrant magenta bags contain 4 shiny fuchsia bags, 2 shiny coral bags, 3 faded indigo bags, 4 pale tomato bags.\nstriped chartreuse bags contain 2 shiny orange bags, 3 mirrored tomato bags, 1 clear lime bag.\ndotted green bags contain 1 pale beige bag, 2 mirrored bronze bags, 2 wavy crimson bags.\nwavy white bags contain 3 posh magenta bags, 3 muted yellow bags, 3 wavy crimson bags, 4 vibrant olive bags.\nmuted plum bags contain 4 wavy gold bags.\nfaded violet bags contain 3 dark violet bags.\ndull fuchsia bags contain 4 plaid indigo bags, 1 mirrored brown bag, 5 clear lime bags.\nbright green bags contain 3 mirrored white bags, 5 dotted silver bags.\nshiny violet bags contain 4 striped salmon bags.\ndim fuchsia bags contain 3 striped red bags.\nfaded lavender bags contain 3 wavy tan bags, 2 clear lime bags.\ndim cyan bags contain 4 drab white bags.\ndark brown bags contain 5 clear gold bags, 3 vibrant blue bags.\nclear lavender bags contain 5 striped turquoise bags, 1 light crimson bag, 5 light tan bags, 2 muted gold bags.\nlight green bags contain 3 striped silver bags, 4 bright silver bags, 2 light crimson bags.\npale lavender bags contain 5 clear violet bags.\ndotted orange bags contain 3 dotted tomato bags, 2 dull plum bags, 5 posh purple bags, 2 drab turquoise bags.\nbright black bags contain 3 posh chartreuse bags, 5 wavy indigo bags, 5 dull crimson bags, 2 clear turquoise bags.\ndotted gold bags contain 5 striped white bags, 2 striped brown bags, 3 mirrored green bags, 3 dark violet bags.\nplaid brown bags contain 3 striped chartreuse bags, 3 striped black bags, 2 bright chartreuse bags.\nwavy coral bags contain 3 dim turquoise bags, 4 dim lime bags.\npale brown bags contain 4 dim white bags, 5 bright fuchsia bags, 2 clear orange bags.\nmirrored teal bags contain 4 pale lavender bags, 5 vibrant maroon bags, 4 striped gray bags, 4 vibrant indigo bags.\nposh orange bags contain 5 posh magenta bags, 4 posh violet bags, 2 plaid magenta bags, 4 muted cyan bags.\ndim crimson bags contain 3 drab violet bags, 1 dotted aqua bag.\nmuted gray bags contain 4 vibrant lime bags, 1 dark maroon bag, 2 clear gold bags, 3 plaid gray bags.\nclear brown bags contain 5 shiny tomato bags, 4 striped tan bags, 5 vibrant lavender bags, 1 pale white bag.\nposh crimson bags contain 3 dim yellow bags, 4 shiny turquoise bags, 2 vibrant purple bags, 4 mirrored aqua bags.\nplaid black bags contain 2 shiny tan bags, 1 pale olive bag, 2 wavy tan bags, 1 clear red bag.\ndark crimson bags contain 3 drab fuchsia bags, 5 faded gold bags.\npale tan bags contain 5 posh black bags.\nwavy bronze bags contain 1 clear lime bag.\nwavy gold bags contain 2 dull lavender bags, 1 bright turquoise bag, 4 striped brown bags, 5 drab turquoise bags.\npale lime bags contain 2 faded cyan bags, 4 muted salmon bags, 4 shiny coral bags, 3 mirrored green bags.\ndark magenta bags contain 4 faded chartreuse bags, 1 muted brown bag, 4 vibrant salmon bags, 2 dim indigo bags.\nstriped purple bags contain 3 mirrored olive bags.\ndull crimson bags contain 2 clear orange bags.\ndull beige bags contain 1 drab turquoise bag, 1 dark indigo bag, 1 dull white bag.\ndotted aqua bags contain 4 dull chartreuse bags.\nclear purple bags contain 2 muted beige bags, 3 dull black bags.\nlight crimson bags contain 1 faded brown bag, 1 vibrant red bag, 4 wavy lavender bags, 1 wavy gray bag.\nclear fuchsia bags contain 1 dark maroon bag, 3 muted salmon bags.\nmuted crimson bags contain 5 light lime bags, 4 posh plum bags, 5 clear fuchsia bags, 1 wavy turquoise bag.\nmuted purple bags contain 3 dull gray bags, 5 posh gray bags.\nshiny salmon bags contain 5 faded brown bags, 4 clear chartreuse bags.\nplaid lavender bags contain 1 dim lime bag.\nvibrant indigo bags contain 5 dim tomato bags, 2 striped beige bags, 2 mirrored olive bags.\nmirrored cyan bags contain 3 plaid coral bags, 5 faded teal bags, 5 pale indigo bags, 3 bright fuchsia bags.\ndim yellow bags contain 5 light crimson bags, 1 pale tomato bag.\ndotted chartreuse bags contain 3 shiny blue bags.\nlight beige bags contain 3 bright teal bags, 1 pale tomato bag, 2 light blue bags.\ndotted olive bags contain 3 bright indigo bags, 4 muted fuchsia bags.\npale white bags contain 1 vibrant maroon bag, 2 pale tomato bags, 2 bright magenta bags.\nmirrored yellow bags contain 2 drab brown bags, 3 striped salmon bags, 4 clear olive bags, 1 dotted black bag.\nlight olive bags contain 2 bright magenta bags.\nmuted tomato bags contain 4 shiny lavender bags.\nlight chartreuse bags contain 5 light plum bags, 4 light olive bags, 3 dark indigo bags.\nposh purple bags contain 2 wavy crimson bags.\nbright maroon bags contain 4 faded indigo bags.\ndull blue bags contain 3 dark brown bags, 3 dim indigo bags, 5 pale silver bags, 1 mirrored brown bag.\nlight coral bags contain 5 clear teal bags.\nbright gray bags contain 3 muted black bags, 3 vibrant cyan bags.\nposh fuchsia bags contain 3 clear gold bags, 1 dim salmon bag, 2 shiny salmon bags.\nlight white bags contain 3 dim cyan bags, 5 clear crimson bags, 3 dull fuchsia bags.\nlight teal bags contain 3 shiny fuchsia bags, 2 muted white bags, 3 shiny black bags.\nplaid salmon bags contain 2 dotted black bags, 2 dark beige bags, 1 shiny coral bag.\nwavy black bags contain 5 posh olive bags.\ndrab gray bags contain 3 mirrored tomato bags, 3 light crimson bags.\ndim olive bags contain 5 clear chartreuse bags.\nbright white bags contain 2 mirrored tan bags, 1 pale green bag, 5 dull magenta bags, 5 plaid lime bags.\nstriped olive bags contain 3 muted gold bags.\nfaded olive bags contain 1 muted indigo bag.\npale yellow bags contain 5 light olive bags, 5 plaid aqua bags, 1 clear white bag, 5 faded purple bags.\ndull coral bags contain 4 light crimson bags, 5 shiny aqua bags, 5 wavy cyan bags, 3 dark beige bags.\nvibrant beige bags contain 4 striped olive bags, 5 clear gold bags.\ndark fuchsia bags contain 1 pale teal bag, 4 dull gray bags.\ndrab tomato bags contain 4 mirrored white bags.\nclear crimson bags contain 4 pale tomato bags, 3 wavy gray bags, 4 drab blue bags, 1 mirrored olive bag.\ndotted crimson bags contain 1 plaid crimson bag, 1 dark crimson bag, 1 striped beige bag, 4 pale fuchsia bags.\nstriped black bags contain 4 muted maroon bags.\nshiny bronze bags contain 1 dotted tan bag, 1 vibrant beige bag, 5 faded tomato bags.\nlight cyan bags contain no other bags.\nposh black bags contain 2 dim green bags.\nstriped gold bags contain 3 drab tan bags.\nfaded white bags contain 4 pale coral bags.\ndrab tan bags contain 4 clear gold bags, 5 drab silver bags.\nlight tan bags contain 2 dull lime bags, 1 muted salmon bag, 4 pale beige bags.\nplaid indigo bags contain 3 plaid salmon bags, 1 vibrant maroon bag.\nfaded gold bags contain 3 dark coral bags.\ndark salmon bags contain 5 bright gold bags, 1 pale white bag.\nplaid bronze bags contain 3 drab gold bags, 4 dotted black bags.\nshiny black bags contain 3 bright magenta bags, 2 dark indigo bags, 1 posh plum bag, 5 drab gold bags.\npale magenta bags contain 1 clear gold bag, 5 posh fuchsia bags, 2 faded cyan bags."

remove :: String -> String -> String
remove r = replace r ""

type BagRules = Map String Bag

data Bag = Bag
  { name :: String,
    contents :: [(String, Int)]
  }
  deriving (Show)

readBagRules :: String -> BagRules
readBagRules str =
  Map.fromList $ readLine <$> lines sanitisedStr
  where
    sanitisedStr = remove "bag" . remove "bags" . remove "." $ str
    readLine line = (strip name, Bag {name = strip name, contents = parseContents contents})
      where
        [name, contents] = strip <$> splitOn "contain" line
        parseContents c
          | c == "no other" = []
          | otherwise =
            let readItem item = (strip nameStr, read (strip countStr) :: Int)
                  where
                    (countStr, nameStr) = partition isDigit item
             in readItem <$> splitOn ", " c

toGraph :: BagRules -> (Graph, String -> Graph.Vertex)
toGraph rules =
  (graph, fromJust . vertexFromKey)
  where
    (graph, _, vertexFromKey) = Graph.graphFromEdges $ toEdge <$> Map.elems rules
    toEdge Bag {name, contents} = (name, name, fst <$> contents)

countContents :: BagRules -> Bag -> Int
countContents rules Bag {contents} =
  foldr countContents' 0 contents
  where
    countContents' (name, count) total =
      let bag = rules ! name
       in total + count + count * countContents rules bag

partOne :: String -> Int
partOne value =
  length (Graph.reachable (Graph.transposeG ruleGraph) shinyGold) - 1
  where
    (ruleGraph, vertexFromKey) = toGraph $ readBagRules value
    shinyGold = vertexFromKey "shiny gold"

partTwo :: String -> Int
partTwo value =
  countContents rules shinyGold
  where
    rules = readBagRules value
    shinyGold = fromJust $ Map.lookup "shiny gold" rules
